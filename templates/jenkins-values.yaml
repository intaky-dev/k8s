# Jenkins Helm Chart Values
# Simplified and compatible configuration for CI/CD

controller:
  # Jenkins Controller Configuration
  componentName: "jenkins-controller"

  # Resources
  resources:
    requests:
      cpu: "500m"
      memory: "2Gi"
    limits:
      cpu: "2000m"
      memory: "4Gi"

  # Java options for better performance
  javaOpts: "-Xms2048m -Xmx2048m"

  # Service configuration
  serviceType: ClusterIP
  servicePort: 8080

  # Install essential plugins
  installPlugins:
    # Core
    - kubernetes:4253.v7700d91739e5
    - workflow-aggregator:600.vb_57cdd26fdd7
    - git:5.5.2
    - configuration-as-code:1850.va_a_8c31d3158b_

    # Docker
    - docker-workflow:580.vc0c340686b_54

    # Pipeline
    - pipeline-stage-view:2.34
    - pipeline-graph-view:323.v6a_7fb_7e8b_fef

    # SCM
    - github:1.40.0
    - github-branch-source:1797.v86fdb_4d57d43

    # Credentials
    - credentials-binding:681.vf91669a_32e45

    # UI
    - blueocean:1.27.15

    # Utilities
    - prometheus:812.va_f28a_7ab_b_35f
    - ansicolor:1.0.4

  # Jenkins Configuration as Code
  JCasC:
    defaultConfig: true
    configScripts:
      welcome-message: |
        jenkins:
          systemMessage: |
            Welcome to Jenkins CI/CD Server
            Configured with Kubernetes agents and Docker support

      kubernetes-cloud: |
        jenkins:
          clouds:
            - kubernetes:
                name: "kubernetes"
                serverUrl: "https://kubernetes.default"
                namespace: "jenkins"
                jenkinsUrl: "http://jenkins:8080"
                jenkinsTunnel: "jenkins-agent:50000"
                containerCapStr: "10"
                templates:
                  - name: "jenkins-agent"
                    label: "jenkins-agent"
                    nodeUsageMode: NORMAL
                    containers:
                      - name: "jnlp"
                        image: "jenkins/inbound-agent:latest"
                        alwaysPullImage: false
                        workingDir: "/home/jenkins/agent"
                        ttyEnabled: true
                        resourceRequestCpu: "500m"
                        resourceRequestMemory: "512Mi"
                        resourceLimitCpu: "1000m"
                        resourceLimitMemory: "1Gi"

                  - name: "docker-agent"
                    label: "docker"
                    nodeUsageMode: NORMAL
                    containers:
                      - name: "jnlp"
                        image: "jenkins/inbound-agent:latest"
                        workingDir: "/home/jenkins/agent"
                        resourceRequestCpu: "500m"
                        resourceRequestMemory: "512Mi"
                      - name: "docker"
                        image: "docker:dind"
                        privileged: true
                        workingDir: "/home/jenkins/agent"
                        resourceRequestCpu: "500m"
                        resourceRequestMemory: "512Mi"
                    volumes:
                      - emptyDirVolume:
                          memory: false
                          mountPath: "/var/lib/docker"

      security: |
        jenkins:
          securityRealm:
            local:
              allowsSignup: false
          authorizationStrategy:
            loggedInUsersCanDoAnything:
              allowAnonymousRead: false

# Persistence for Jenkins home
persistence:
  enabled: true
  storageClass: "local-path"
  size: "20Gi"

# Service Account
serviceAccount:
  create: true
  name: jenkins

# RBAC
rbac:
  create: true
  readSecrets: true

# Backup (disabled by default)
backup:
  enabled: false
